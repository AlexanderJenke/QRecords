var QRecords=function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.goto=t.run=void 0;var r=n(1),i=n(6),o=function(){function e(e){this.json=e,this.allergies=[],this.medications=[],this.diagnoses=[],this.build()}return e.prototype.build=function(){var e,t,n;for(document.getElementById("checksum").innerText="CodeID: "+this.json.checksum.toString(),this.addListElement("date",document.createTextNode(this.json.getGenerationDateText())),this.addListElement("emergency_contact",document.createTextNode(this.json.phoneContact.name)),e=this.json.phoneContact.number.toString(),t=this.createLink("tel:"+e,document.createTextNode(e)),this.addListElement("emergency_contact",t),this.addListElement("doctors_contact",document.createTextNode(this.json.phoneMedical.name)),e=this.json.phoneMedical.number.toString(),t=this.createLink("tel:"+e,document.createTextNode(e)),this.addListElement("doctors_contact",t),n=0;n<this.json.allergies.length;n++)this.allergies.push(this.addListElement("allergies_list",this.createSpinner()));for(n=0;n<this.json.medications.length;n++)this.medications.push(this.addListElement("medications_list",this.createSpinner()));for(n=0;n<this.json.diagnoses.length;n++)this.diagnoses.push(this.addListElement("diagnoses_list",this.createSpinner()));this.addListElement("notes_list",document.createTextNode(this.json.notes.toString())),this.update()},e.prototype.addListElement=function(e,t){var n=document.createElement("LI");return n.className="list-group-item",n.appendChild(t),document.getElementById(e).appendChild(n),n},e.prototype.updateListContent=function(e,t){e.innerHTML="",e.appendChild(t)},e.prototype.createLink=function(e,t){var n=document.createElement("A");return n.href=e,n.target="_blank",n.appendChild(t),n},e.prototype.createSpinner=function(){var e=document.createElement("SPAN");return e.className="spinner-border text-secondary mb-0",e.role="status",e},e.prototype.update=function(){var e,t,n,r;for(e=0;e<this.json.allergies.length;e++)this.updateListContent(this.allergies[e],document.createTextNode(this.json.allergies[e]));var i=this.json.medications;for(e=0;e<i.length;e++)i[e].resolved&&(t=document.createElement("SPAN"),n=document.createTextNode(i[e].name),""!==i[e].ref&&(n=this.createLink(i[e].ref,n)),t.appendChild(n),t.appendChild(document.createElement("BR")),t.appendChild(document.createTextNode(i[e].intervals.toString())),this.updateListContent(this.medications[e],t));var o=this.json.diagnoses;for(e=0;e<o.length;e++)if(o[e].resolved){(t=document.createElement("SPAN")).className="row align-items-start",(r=document.createElement("SPAN")).className="col-2 mb-0",r.appendChild(document.createTextNode(o[e].icd.toString())),t.appendChild(r),n=document.createTextNode(o[e].name),""!==o[e].ref&&(n=this.createLink(o[e].ref,n));var s=document.createElement("SPAN");s.className="col",s.appendChild(n),t.appendChild(s),this.updateListContent(this.diagnoses[e],t)}},e}();t.goto=function(e){e.scrollIntoView(!0)},t.run=function(){var e=new r.Decoder(document.URL.split("#").length>1?document.URL.split("#")[1]:null).decode(),t=new o(e);new i.Resolver(e,t.update.bind(t)).resolve()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QRContents=t.PhoneNumber=t.MedicationIntervals=t.Medication=t.Diagnose=t.Decoder=void 0;var r=n(2);Object.defineProperty(t,"Diagnose",{enumerable:!0,get:function(){return r.Diagnose}}),Object.defineProperty(t,"Medication",{enumerable:!0,get:function(){return r.Medication}}),Object.defineProperty(t,"MedicationIntervals",{enumerable:!0,get:function(){return r.MedicationIntervals}}),Object.defineProperty(t,"PhoneNumber",{enumerable:!0,get:function(){return r.PhoneNumber}}),Object.defineProperty(t,"QRContents",{enumerable:!0,get:function(){return r.QRContents}});var i=n(3),o=n(4),s=n(5),a=function(){function e(e){this.anchor=e}return e.prototype.getResult=function(){return this.result},e.prototype.decode=function(){var e=s.toByteArray(this.anchor),t=new i.ByteBuffer(e);this.result=new r.QRContents,this.result.checksum=t.generateChecksum(),this.result.generationDate=t.readUnsignedNum(16),this.result.phoneContact=new r.PhoneNumber;var n=t.readUnsignedNum(6);this.result.phoneContact.name=t.readString(n,o.NAME_CHARSET),n=t.readUnsignedNum(6),this.result.phoneContact.number=t.readString(n,o.PHONE_CHARSET),this.result.phoneMedical=new r.PhoneNumber,n=t.readUnsignedNum(6),this.result.phoneMedical.name=t.readString(n,o.NAME_CHARSET),n=t.readUnsignedNum(6),this.result.phoneMedical.number=t.readString(n,o.PHONE_CHARSET);var a=t.readUnsignedNum(6);this.result.allergies=[];for(var d=0;d<a;d++)n=t.readUnsignedNum(6),this.result.allergies=this.result.allergies.concat(t.readString(n,o.NAME_CHARSET));a=t.readUnsignedNum(6),this.result.medications=[];for(d=0;d<a;d++){var u=new r.Medication;u.code=t.readUnsignedNum(24),u.intervals=new r.MedicationIntervals,u.intervals.morning=t.readUnsignedNum(4),u.intervals.lunch=t.readUnsignedNum(4),u.intervals.evening=t.readUnsignedNum(4),u.intervals.night=t.readUnsignedNum(4),u.resolved=!1,this.result.medications=this.result.medications.concat(u)}a=t.readUnsignedNum(6),this.result.diagnoses=[];for(d=0;d<a;d++){var c=new r.Diagnose;c.code=t.readUnsignedNum(14),c.resolved=!1,this.result.diagnoses=this.result.diagnoses.concat(c)}return n=t.readUnsignedNum(12),this.result.notes=t.readString(n,o.VARTEXT_CHARSET),this.result},e}();t.Decoder=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Diagnose=t.MedicationIntervals=t.Medication=t.PhoneNumber=t.QRContents=void 0;var r=function(){function e(){}return e.prototype.getGenerationDateText=function(){return new Date(24*this.generationDate*60*60*1e3).toDateString()},e}();t.QRContents=r;var i=function(){};t.PhoneNumber=i;var o=function(){};t.Medication=o;var s=function(){function e(){}return e.prototype.toString=function(){return this.morning.toString()+" / "+this.lunch.toString()+" / "+this.evening.toString()+" / "+this.night.toString()},e}();t.MedicationIntervals=s;var a=function(){};t.Diagnose=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ByteBuffer=void 0;var r=function(){function e(e){this.data=e,this.position=0}return e.prototype.isBitSet=function(e){var t=e>>3,n=128>>(e%=8);return(this.data[t]&n)==n},e.prototype.setBit=function(e,t){var n=e>>3,r=128>>(e%=8);t?this.data[n]|=r:(r=~r,this.data[n]&=r)},e.prototype.readBit=function(){var e=this.isBitSet(this.position);return this.position++,e},e.prototype.readUnsignedNum=function(e){for(var t=0,n=0;n<e;n++)this.readBit()&&(t+=1<<e-n-1);return t},e.prototype.readBinary=function(e){for(var t=new Uint8Array((e>>3)+(e%8==0?0:1)),n=(8-e%8)%8,r=0;r<e;r++){var i=n+r;if(this.readBit()){var o=i>>3,s=128>>(i%=8);t[o]|=s}}return t},e.prototype.readString=function(e,t){for(var n=Math.ceil(Math.log(t.length)/Math.log(2)),r="",i=0;i<e;i++)r+=t.charAt(this.readUnsignedNum(n));return r},e.prototype.writeBit=function(e){this.setBit(this.position,e),this.position++},e.prototype.writeUnsignedNum=function(e,t){for(var n=0;n<t;n++){var r=1<<t-n-1;this.writeBit((r&e)==r)}},e.prototype.writeBinary=function(e,t){for(var n=(8-t%8)%8,r=0;r<t;r++){var i=n+r,o=i>>3,s=128>>(i%=8);this.writeBit((e[o]&s)==s)}},e.prototype.writeString=function(e,t){for(var n=Math.ceil(Math.log(t.length)/Math.log(2)),r=0;r<e.length;r++){var i=t.indexOf(e.charAt(r));-1==i&&(i=0),this.writeUnsignedNum(i,n)}},e.prototype.rewind=function(){this.position=0},e.prototype.getPosition=function(){return this.position},e.prototype.finalize=function(){for(var e=(this.position>>3)+(this.position%8==0?0:1),t=new Uint8Array(e),n=0;n<e;n++)t[n]=this.data[n];return this.data=t,t},e.prototype.generateChecksum=function(){var e=this.position;this.rewind();for(var t=Math.floor(8*this.data.length/13),n=0,r=0;r<t;r++)n^=this.readUnsignedNum(13);return this.position=e,n},e}();t.ByteBuffer=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PHONE_CHARSET=t.NAME_CHARSET=t.VARTEXT_CHARSET=void 0,t.VARTEXT_CHARSET="? 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz.!-+_=><ÄÖÜäöüßáàâéeêìíîóòôúùûÁÀÂÉÈÊÍÌÎÓÒÔÚÙÛ",t.NAME_CHARSET="? ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-ÄÖÜäöüßáàâéeêìíîóòôúùûÁÀÂÉÈÊÍÌÎÓÒÔÚÙÛ",t.PHONE_CHARSET="? 0123456789+"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fromByteArray=t.toByteArray=void 0;for(var r=[],i=[],o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,a=o.length;s<a;++s)r[s]=o[s],i[o.charCodeAt(s)]=s;function d(e,t,n){for(var i,o,s=[],a=t;a<n;a+=3)i=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),s.push(r[(o=i)>>18&63]+r[o>>12&63]+r[o>>6&63]+r[63&o]);return s.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63,t.toByteArray=function(e){var t,n,r=function(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}(e),o=r[0],s=r[1],a=new Uint8Array(function(e,t,n){return 3*(t+n)/4-n}(0,o,s)),d=0,u=s>0?o-4:o;for(n=0;n<u;n+=4)t=i[e.charCodeAt(n)]<<18|i[e.charCodeAt(n+1)]<<12|i[e.charCodeAt(n+2)]<<6|i[e.charCodeAt(n+3)],a[d++]=t>>16&255,a[d++]=t>>8&255,a[d++]=255&t;return 2===s&&(t=i[e.charCodeAt(n)]<<2|i[e.charCodeAt(n+1)]>>4,a[d++]=255&t),1===s&&(t=i[e.charCodeAt(n)]<<10|i[e.charCodeAt(n+1)]<<4|i[e.charCodeAt(n+2)]>>2,a[d++]=t>>8&255,a[d++]=255&t),a},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,o=[],s=0,a=n-i;s<a;s+=16383)o.push(d(e,s,s+16383>a?a:s+16383));return 1===i?(t=e[n-1],o.push(r[t>>2]+r[t<<4&63]+"==")):2===i&&(t=(e[n-2]<<8)+e[n-1],o.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"=")),o.join("")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Resolver=void 0,Number.prototype.zfill=function(e){for(var t=String(this);t.length<e;)t="0"+t;return t};var r=function(){function e(e,t){this.result=e,this.callback=t}return e.prototype.resolve=function(){function e(){if(200===this.xhr.status)for(var e=this.xhr.responseURL.split("/").pop(),t=JSON.parse(this.xhr.responseText),n=this.result.medications,r=0;r<n.length;r++)if(Math.floor(n[r].code/100).toString()===e){var i=n[r].code.zfill(5);t.hasOwnProperty(i)&&(n[r].name=t[i].name,n[r].ref=t[i].ref,n[r].resolved=!0)}this.callback()}function t(){if(200===this.xhr.status)for(var e=this.xhr.responseURL.split("/").pop(),t=JSON.parse(this.xhr.responseText),n=this.result.diagnoses,r=0;r<n.length;r++)if(Math.floor(n[r].code/100).toString()===e){var i=n[r].code.zfill(5);t.hasOwnProperty(i)&&(n[r].icd=t[i].icd,n[r].name=t[i].name,n[r].ref=t[i].ref,n[r].resolved=!0)}this.callback()}for(var n=[],r=[],i=0;i<this.result.medications.length;i++){var o=Math.floor(this.result.medications[i].code/100);n.indexOf(o)&&n.push(o)}for(i=0;i<this.result.diagnoses.length;i++){o=Math.floor(this.result.diagnoses[i].code/100);r.indexOf(o)&&r.push(o)}for(i=0;i<n.length;i++){(s=new XMLHttpRequest).open("GET","./PZN/"+n[i].toString()),s.onload=e.bind({xhr:s,result:this.result,callback:this.callback}),s.send()}for(i=0;i<r.length;i++){var s;(s=new XMLHttpRequest).open("GET","./ICD/"+r[i].toString()),s.onload=t.bind({xhr:s,result:this.result,callback:this.callback}),s.send()}},e}();t.Resolver=r}]);